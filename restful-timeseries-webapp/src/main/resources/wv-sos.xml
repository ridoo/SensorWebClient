<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.2.xsd 
    http://www.springframework.org/schema/mvc 
    http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd">

    <mvc:annotation-driven />
    
    <bean name="sos-proxy" class="org.n52.server.series.proxy.TimeseriesServiceImpl">
       <constructor-arg name="componentNameToBeProxied" value="sos_proxy" />
       <property name="phenomenonaService" ref="phenomenonParameterService" />
       <property name="procedureService" ref="phenomenonParameterService" />
       <property name="categoryService" ref="categoryParameterService" />
       <property name="offeringService" ref="offeringParameterService" />
       <property name="featureService" ref="featureParameterService" />
       <property name="stationService" ref="stationParameterService" />
       <property name="timeseriesService" ref="timeseriesService" />
       <property name="timeseriesDataService" ref="timeseriesService" />
       <property name="servicesService" ref="serviceParameterService" />
       <property name="searchService" ref="searchService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.OfferingsParameterController">
        <property name="parameterService" ref="offeringParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.ServicesParameterController">
        <property name="parameterService" ref="serviceParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.CategoriesParameterController">
        <property name="parameterService" ref="categoryParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.FeaturesParameterController">
        <property name="parameterService" ref="featureParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.ProceduresParameterController">
        <property name="parameterService" ref="procedureParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.PhenomenaParameterController">
        <property name="parameterService" ref="phenomenonParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.StationsParameterController">
        <property name="parameterService" ref="stationParameterService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.TimeseriesMetadataController">
        <property name="serviceParameterService" ref="serviceParameterService" />
        <property name="parameterService" ref="timeseriesService" />
        <property name="configAppliers">
          <list>
              <bean class="org.n52.io.RenderingHintsConfigApplier" />
              <bean class="org.n52.io.StatusIntervalsConfigApplier" />
          </list>
        </property>
    </bean>
    
    <bean class="org.n52.web.v1.ctrl.SearchController">
       <property name="searchService" ref="searchService" />
    </bean>

    <bean class="org.n52.web.v1.ctrl.TimeseriesDataController">
        <property name="serviceParameterService" ref="serviceParameterService" />
        <property name="timeseriesMetadataService" ref="timeseriesService" />
        <property name="timeseriesDataService" ref="timeseriesService" />
        <property name="preRenderingTask" ref="preRenderingTask" />
        <property name="requestIntervalRestriction" value="P1Y" />
    </bean>

    <bean id="preRenderingTask" class="org.n52.io.PreRenderingTask"
        destroy-method="shutdownTask" factory-method="createTask">
        <property name="timeseriesMetadataService" ref="timeseriesService" />
        <property name="timeseriesDataService" ref="timeseriesService" />
        <property name="outputPath" value="generated/prerendered" />
        <property name="width" value="800" />
        <property name="height" value="500" />
        <property name="language" value="de" />
        <property name="showGrid" value="true" />
        <property name="periodInMinutes" value="1440" />
        <property name="enabled" value="true" />
    </bean>

    <bean id="serviceInfo" class="org.n52.api.sos.v1.da.beans.ServiceInfo">
        <property name="serviceId" value="1" />
        <property name="serviceDescription" value="Wupperverband Timeseries Service." />
    </bean>
    
    <bean id="serviceInfoAccess" class="org.n52.sos.api.v1.srv.ServiceInfoAccess" abstract="true">
        <property name="serviceInfo" ref="serviceInfo" />
    </bean>
    
    <bean id="serviceParameterService" class="org.n52.sos.api.v1.srv.ServiceAccessService" parent="serviceInfoAccess" />
    <bean id="offeringParameterService" class="org.n52.sos.api.v1.srv.OfferingsAccessService" parent="serviceInfoAccess" />
    <bean id="categoryParameterService" class="org.n52.sos.api.v1.srv.CategoriesAccessService" parent="serviceInfoAccess" />
    <bean id="featureParameterService" class="org.n52.sos.api.v1.srv.FeaturesAccessService" parent="serviceInfoAccess" />
    <bean id="procedureParameterService" class="org.n52.sos.api.v1.srv.ProceduresAccessService" parent="serviceInfoAccess" />
    <bean id="stationParameterService" class="org.n52.sos.api.v1.srv.StationsAccessService" parent="serviceInfoAccess" >
       <constructor-arg name="dbSrid" value="EPSG:31466" />
    </bean>
    <bean id="phenomenonParameterService" class="org.n52.sos.api.v1.srv.PhenomenaAccessService"  parent="serviceInfoAccess" />
    <bean id="timeseriesService" class="org.n52.sos.api.v1.srv.TimeseriesAccessService" parent="serviceInfoAccess" />
    <bean id="searchService" class="org.n52.sos.api.v1.srv.Search" parent="serviceInfoAccess" />
    <bean id="metadataService" class="org.n52.sos.api.v1.srv.MetadataAccessService" />

</beans>